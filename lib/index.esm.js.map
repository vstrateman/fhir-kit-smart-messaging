{"version":3,"file":"index.esm.js","sources":["../src/index.js"],"sourcesContent":["// Create a global stack, event listener with callback function\nwindow.eventHandlersByMessageId = {};\nwindow.addEventListener(\"message\", receiveMessage, false);\n\nfunction receiveMessage(event) {\n  event &&\n    event.data &&\n    event.data.responseToMessageId &&\n    eventHandlersByMessageId[event.data.responseToMessageId] &&\n    eventHandlersByMessageId[event.data.responseToMessageId](event);\n}\n\n\n/**\n * SmartMessenger\n *\n * @example\n *\n * const urlParams = new URLSearchParams(window.location.search);\n * const targetOrigin = urlParams.get('smart_messaging_origin') || '*';\n * const targetWindow = window.opener || window.parent;\n *\n * const messenger = new SmartMessenger(targetOrigin, targetWindow);\n * const payload = { resourceType: \"Basic\" };\n *\n * messenger.send('scratchpad.create', payload, (event) => {\n *  console.log(event);\n *  // ...\n * });\n *\n */\nclass SmartMessenger {\n  constructor(targetOrigin, targetWindow) {\n    this.targetOrigin = targetOrigin;\n    this.targetWindow = targetWindow;\n  }\n\n  // Build message, postMessage and add to the eventHandler stack\n  send(type, payload, eventHandler) {\n    const message = this.buildMessage(type, payload);\n    this.targetWindow.postMessage(message, targetOrigin);\n    eventHandlersByMessageId[message.messageId] = eventHandler;\n  }\n\n  buildMessage(type, payload) {\n    return {\n      messageId: this.guid(),\n      messageType: type,\n      payload: payload\n    };\n  }\n\n  // TODO: Use a proper UUID generator, this is just to keep the\n  //       dependencies null\n  s4() {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n\n  guid() {\n    return this.s4() + this.s4() + '-' +\n      this.s4() + '-' + this.s4() + '-' +\n      this.s4() + '-' + this.s4() + this.s4() + this.s4();\n  }\n}\n"],"names":["window","eventHandlersByMessageId","addEventListener","receiveMessage","event","data","responseToMessageId"],"mappings":"AACAA,OAAOC,wBAAP,GAAkC,EAAlC;AACAD,OAAOE,gBAAP,CAAwB,SAAxB,EAAmCC,cAAnC,EAAmD,KAAnD;;AAEA,SAASA,cAAT,CAAwBC,KAAxB,EAA+B;WAE3BA,MAAMC,IADR,IAEED,MAAMC,IAAN,CAAWC,mBAFb,IAGEL,yBAAyBG,MAAMC,IAAN,CAAWC,mBAApC,CAHF,IAIEL,yBAAyBG,MAAMC,IAAN,CAAWC,mBAApC,EAAyDF,KAAzD,CAJF;"}